<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversor de Itens Guild Arena7</title>
    <style>
        /* (Mantido igual ao seu estilo original) */
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
            position: relative;
            padding: 20px;
        }
        /* ... (todo o resto do seu CSS permanece igual) ... */
    </style>
</head>
<body>
    <!-- (Todo o seu HTML permanece igual) -->
    <div class="main-container">
        <!-- Abas para navegação -->
        <div class="tab">
            <!-- ... (conteúdo das abas igual ao seu original) ... -->
        </div>
    </div>
    
    <div class="footer">Feito por -maykin-_-</div>
    
    <!-- Firebase SDK - VERSÃO ATUALIZADA -->
<script type="module">
    // Importe apenas o necessário
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { 
        getFirestore, 
        collection, 
        addDoc, 
        getDocs, 
        doc, 
        deleteDoc,
        updateDoc
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // SUAS configurações (que você acabou de obter)
    const firebaseConfig = {
        apiKey: "AIzaSyCHiBHZbP0kJ50ntpxPTPkAY8FS68Bsi3k",
        authDomain: "guildarena7-itens-final.firebaseapp.com",
        projectId: "guildarena7-itens-final",
        storageBucket: "guildarena7-itens-final.appspot.com", // Corrigi para .appspot.com
        messagingSenderId: "215331709133",
        appId: "1:215331709133:web:636349117e86b648ff8984"
    };

    // Inicialize o Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const itemsCollection = collection(db, "arena7Items");

    // Debug (verifique no console F12)
    console.log("Firebase inicializado!");

    // Disponibiliza as funções globalmente
    window.firebaseItems = {
        itemsCollection,
        addDoc, 
        getDocs, 
        doc, 
        deleteDoc,
        updateDoc
    };
</script>

    <script>
        // Função para abrir abas (igual à sua original)
        function openTab(evt, tabName) {
            /* ... (mantido igual) ... */
        }

        // Função para validar o formato do valor (igual à sua original)
        function isValidValue(value) {
            /* ... (mantido igual) ... */
        }

        // Função para adicionar item (ATUALIZADA COM DEBUG)
        async function addItem() {
            const name = document.getElementById("itemName").value.trim();
            const buyValue = document.getElementById("buyValue").value.trim();
            const sellValue = document.getElementById("sellValue").value.trim();
            const errorElement = document.getElementById("errorMessage");

            // Validações (mantidas iguais)
            if (!name || !buyValue || !sellValue) {
                errorElement.textContent = "Todos os campos devem ser preenchidos!";
                return;
            }

            if (!isValidValue(buyValue) || !isValidValue(sellValue)) {
                errorElement.textContent = "Formato inválido! Use números com unidades (ex: 1fg, 0.5s, 1w+2fg)";
                return;
            }

            errorElement.textContent = "";

            try {
                console.log("Tentando cadastrar item..."); // Debug
                
                const docRef = await firebaseItems.addDoc(firebaseItems.itemsCollection, {
                    name: name,
                    buyValue: buyValue,
                    sellValue: sellValue,
                    approved: false,
                    createdAt: new Date()
                });
                
                console.log("Item cadastrado com ID:", docRef.id); // Debug
                
                document.getElementById("itemName").value = '';
                document.getElementById("buyValue").value = '';
                document.getElementById("sellValue").value = '';
                
                alert("Item cadastrado! Aguarde aprovação.");
            } catch (error) {
                console.error("Erro detalhado:", error); // Debug aprimorado
                errorElement.textContent = "Erro ao cadastrar item. Verifique o console (F12) para detalhes.";
            }
        }

        // ... (todas as outras funções permanecem IGUAIS às suas originais) ...

        // Funções originais mantidas:
        // - loadItemsTable()
        // - deleteItem()
        // - searchItems()
        // - approveItem()
        // - checkAdmin()
        // - loadPendingItems()
        // - converter()
        
        // Carrega os itens quando a página é aberta
        window.onload = function() {
            console.log("Página carregada, iniciando..."); // Debug
            loadItemsTable();
        };
    </script>
</body>
</html>
