<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversor de Itens Guild Arena7</title>
    <style>
        /* (Mantendo os estilos anteriores) */
        .unit-hint {
            font-size: 12px;
            color: #666;
            margin-top: -5px;
            margin-bottom: 10px;
        }
        .error-message {
            color: red;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <!-- (Mantendo a estrutura HTML anterior) -->

    <script>
        // Função para validar o formato do valor
        function isValidValue(value) {
            if (!value) return false;
            // Padrão para formatos como 1s, 2w, 3fg, 1s+2w, 1s+3w+5fg, etc.
            const pattern = /^(\d+[swfgbd])+(\+\d+[swfgbd])*$/i;
            return pattern.test(value.replace(/\s+/g, ''));
        }

        // Função para adicionar item
        function addItem() {
            const name = document.getElementById("itemName").value.trim();
            const buyValue = document.getElementById("buyValue").value.trim();
            const sellValue = document.getElementById("sellValue").value.trim();

            // Validação dos campos
            if (!name || !buyValue || !sellValue) {
                alert("Todos os campos devem ser preenchidos!");
                return;
            }

            if (!isValidValue(buyValue) || !isValidValue(sellValue)) {
                alert("Formato inválido para valores! Use algo como '1s', '2w+3fg' ou '1s+2w+5br'");
                return;
            }

            const newItem = {
                id: Date.now(),
                name: name,
                buyValue: buyValue,
                sellValue: sellValue,
                approved: false // Itens começam como não aprovados
            };

            itemsData.push(newItem);
            saveItems();
            loadItemsTable();

            // Limpar campos
            document.getElementById("itemName").value = '';
            document.getElementById("buyValue").value = '';
            document.getElementById("sellValue").value = '';

            alert("Item cadastrado! Aguarde aprovação.");
        }

        // Função para aprovar item (só você pode fazer isso)
        function approveItem(id) {
            if (confirm("Deseja aprovar este item?")) {
                const item = itemsData.find(item => item.id === id);
                if (item) {
                    item.approved = true;
                    saveItems();
                    loadItemsTable();
                }
            }
        }

        // Modificar a função que carrega a tabela para mostrar apenas itens aprovados
        function loadItemsTable(filter = '') {
            const tbody = document.getElementById("itemsTableBody");
            tbody.innerHTML = '';

            const filteredItems = itemsData.filter(item => {
                const matchesSearch = item.name.toLowerCase().includes(filter.toLowerCase());
                return item.approved && matchesSearch;
            });

            if (filteredItems.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5">Nenhum item aprovado encontrado</td></tr>';
                return;
            }

            filteredItems.forEach(item => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.buyValue}</td>
                    <td>${item.sellValue}</td>
                    <td>
                        <button onclick="deleteItem(${item.id})">Excluir</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Adicionar uma nova aba para aprovação de itens (só visível para você)
        function checkAdmin() {
            // Verifica se é você (pode usar um prompt de senha ou outro método)
            const isAdmin = confirm("Você é o administrador?");
            if (isAdmin) {
                document.getElementById("adminTab").style.display = 'block';
                loadPendingItems();
            }
        }

        // Função para carregar itens pendentes
        function loadPendingItems() {
            const pendingItems = itemsData.filter(item => !item.approved);
            const tbody = document.getElementById("pendingItemsBody");
            tbody.innerHTML = '';

            if (pendingItems.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5">Nenhum item pendente</td></tr>';
                return;
            }

            pendingItems.forEach(item => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.buyValue}</td>
                    <td>${item.sellValue}</td>
                    <td>
                        <button onclick="approveItem(${item.id})">Aprovar</button>
                        <button onclick="deleteItem(${item.id})">Rejeitar</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
    </script>
</body>
</html>
